#!/usr/bin/env python
import sys, base64, httplib, json;

if len(sys.argv) < 2 :
    print >> sys.stderr, "Usage: issueLookup ID [ID...]"
    exit(1)

JIRA_URL="tekcomms-jira.global.tektronix.net:8085"
JIRA_AUTH="jirareadonly:jirareadonly"

issue_list= sys.argv[1:]

auth = base64.encodestring(JIRA_AUTH).replace('\n', '')
jira_rest= httplib.HTTPConnection(JIRA_URL)
jira_rest.set_debuglevel(0)

for issue_id in issue_list:
  req_uri="/rest/api/2/issue/" + issue_id
  jira_rest.putrequest("GET", req_uri)
  jira_rest.putheader("Content-Type", "application/json")
  jira_rest.putheader("Authorization", "Basic " + auth)
  jira_rest.putheader("User-Agent", "issuelookup")
  jira_rest.endheaders()
  jira_rest.send("")
  jira_resp= jira_rest.getresponse()
  if jira_resp.status != 200:
    print "Error:", jira_resp.status, jira_resp.reason
    exit(2)
  jira_resp_txt= jira_resp.read();
  json_issue= json.loads(jira_resp_txt, strict=False)
  # print json.dumps(json_issue, indent=2);
  print '%s: %s' % (json_issue['key'], json_issue['fields']['summary'])
  print 'Status= %s' % json_issue['fields']['status']['name']
exit(0)
